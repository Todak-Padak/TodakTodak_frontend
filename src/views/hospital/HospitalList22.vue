<template>
    <v-container fluid class="custom-container">
        <v-spacer :style="{ height: '50px' }"></v-spacer>
        <v-row>
            <!-- gps ÏúÑÏπòÏ†ïÎ≥¥ -->
            <v-col cols="4"
            class="justify-start text-no-wrap"
            >
                <v-btn variant="flat" size="large" @click="openAddressSearch">
                    <h4> 
                        <!-- <v-icon> mdi-crosshairs-gps</v-icon> -->
                        üìç {{dong}}
                        <v-icon class="custom-width ml-n1"> mdi-chevron-down</v-icon>
                    </h4>
                </v-btn>
            </v-col>
            <!-- Ï£ºÎ≥ÄÏÜåÏïÑÍ≥º ÌÉÄÏù¥ÌãÄ -->
            <v-col cols="4" 
            class="d-flex flex-row justify-center text-no-wrap"
            align="center"
            >
                <h2>üë∂üèª Ï£ºÎ≥Ä ÏÜåÏïÑÍ≥º</h2>
            </v-col>

            <v-col cols="4">
                <!-- Í≥µÍ∞Ñ ÎßûÏ∂îÍ∏∞ÏúÑÌïú Îπà col -->
            </v-col>
        </v-row>

        <v-spacer :style="{ height: '30px' }"></v-spacer>

        <v-row>
            <!-- Ï†ïÎ†¨Ï°∞Í±¥ (Í±∞Î¶¨ Ïàú, Î≥ÑÏ†ê Ïàú, Î¶¨Î∑∞ Ïàú) -->
            <v-col cols="2"> 
                <v-autocomplete
                v-model="sort"
                :items="sortOptions.map(option => option.text)"
                density="comfortable"
                label="Ï†ïÎ†¨Ï°∞Í±¥"
                class="mt-n1"
              ></v-autocomplete> 
            </v-col>
            <!-- Î≥ëÏõêÍ≤ÄÏÉâ Ï∞Ω -->
            <v-col cols="8">
                <v-text-field
                v-model="search"
                label="Î≥ëÏõêÍ≤ÄÏÉâ"
                prepend-inner-icon="mdi-magnify"
                variant="underlined"
                type="text"
                clearable
                class="mt-n1"
              ></v-text-field>
            </v-col>
            <!-- ÏßÑÎ£åÏ§ë Î≤ÑÌäº -->
            <!-- <v-col cols="2" >
                <v-btn variant="tonal" rounded="lg" size="large" color="#0066FF"> ÏßÑÎ£åÏ§ë </v-btn>
            </v-col> -->
        </v-row>

        <v-spacer></v-spacer>
        <!-- ÌïÑÌÑ∞ ÌÉúÍ∑∏ Í∑∏Î£πÎì§ -->
        <v-chip-group
            v-model="selectedTag"
            selected-class="text-primary"
            mandatory
        >
            <v-chip value="Ï†ÑÏ≤¥" size="large" filter>Ï†ÑÏ≤¥</v-chip>
            <v-chip value="ÏòÅÏú†ÏïÑÍ≤ÄÏßÑ" size="large" filter>ÏòÅÏú†ÏïÑÍ≤ÄÏßÑ</v-chip>
            <v-chip value="Ï†ÑÎ¨∏Ïùò" size="large" filter>Ï†ÑÎ¨∏Ïùò</v-chip>
            <v-chip value="Ï£ºÏ∞®Ïû•" size="large" filter>Ï£ºÏ∞®Ïû•</v-chip>
            <v-chip value="Ïñ¥Î¶∞Ïù¥ Íµ≠Í∞ÄÏòàÎ∞©Ï†ëÏ¢Ö" size="large" filter>Ïñ¥Î¶∞Ïù¥ Íµ≠Í∞ÄÏòàÎ∞©Ï†ëÏ¢Ö</v-chip>
            <v-chip value="ÏòàÎ∞©Ï†ëÏ¢Ö" size="large" filter>ÎπÑÎåÄÎ©¥</v-chip>
            <v-chip value="Ïã†ÏÜçÌï≠Ïõê" size="large" filter>Ïã†ÏÜçÌï≠Ïõê</v-chip>
        </v-chip-group>

        <v-spacer :style="{ height: '20px' }"></v-spacer>
        <!-- Î≥ëÏõêÎ¶¨Ïä§Ìä∏ -->
        <v-row>
            <v-col cols="12" v-for="hospital in hospitalList" :key="hospital.id">
                <v-card
                    style="width: 1000px; max-width: 100%; margin-left: 0; margin-right: auto !important;"
                    variant="outlined"
                    class="custom-card justify-start"
                    @click="goToDetail(hospital.id)"
                    clickable
                >
                    <div class="d-flex flex-no-wrap">
                        <v-avatar
                            class="ma-5"
                            style="height:140px; width:180px; border-radius: 10px; object-fit:cover;"
                        >
                            <v-img :src="hospital.hospitalImageUrl" />
                        </v-avatar>
        
                        <div style="flex: 1;">
                            <div class="d-flex flex-row align-center justify-space-between">
                                <!-- Î≥ëÏõê Ïù¥Î¶Ñ -->
                                <div class="d-flex flex-row align-center">
                                    <v-card-title class="mt-2 ml-n4 custom-card-title">
                                    {{ hospital.name }}
                                    </v-card-title>
                                    <!-- Î≥ëÏõê ÌèâÍ∑†ÌèâÏ†ê, Î¶¨Î∑∞Í∞úÏàò -->
                                    <v-card-text class="rating-text mt-4 ml-n7">
                                    <v-icon color="#00499E">mdi-star</v-icon>
                                    {{ hospital.averageRating }} ({{ hospital.reviewCount }})
                                    </v-card-text>
                                </div>
                    
                                <!-- ÎåÄÍ∏∞ Ïù∏Ïõê (Ïò§Î•∏Ï™Ω Ï†ïÎ†¨) -->
                                <v-chip color="#0066FF" size="large" class="ml-auto mr-10 mt-2">
                                    <strong>ÎåÄÍ∏∞ {{ hospital.standby ?? 0 }}Î™Ö</strong>
                                </v-chip>
                            </div>
                
                            <!-- Ïò§Îäò ÏòÅÏóÖÏãúÍ∞Ñ, ÎÇ¥ÏúÑÏπò ~ Î≥ëÏõê Í±∞Î¶¨ -->
                            <div class="d-flex flex-row align-center">
                                <v-text class="ml-1" style="font-size:18px">
                                    {{ hospital.todaySchedule }}
                                </v-text>
                                <v-text class="ml-3 distance-text" style="font-size:18px">
                                    {{ hospital.distance }}
                                </v-text>
                            </div>
                            <!-- Î≥ëÏõê Ï£ºÏÜå -->
                            <div class="d-flex flex-row align-center mt-1">
                                <v-text style="color:#888888; font-size:17px">
                                    <v-icon>mdi-map-marker-outline</v-icon>
                                    {{ hospital.address }}
                                </v-text>
                            </div>
                            <!-- Î≥ëÏõê ÌÇ§ÏõåÎìú chip -->
                            <div class="d-flex flex-row align-center">
                                <v-chip
                                    v-for="(keyword, index) in hospital.keywordList"
                                    :key="index"
                                    color="#00499E"
                                    size="default"
                                    class="mr-2 mt-2"
                                >
                                    {{ keyword }} 
                                </v-chip>
                            </div>
                        </div>
                    </div>
                </v-card>
            </v-col>
        </v-row>

        <v-spacer :style="{ height: '50px' }"></v-spacer>

    </v-container>
</template>

<script>
import axios from 'axios';

export default{
    data() {
      return {
        dong:"ÏÑ±ÏàòÎèô 2Í∞Ä",
        search:"", 
        sort:"Í±∞Î¶¨ Ïàú", // ÏÇ¨Ïö©ÏûêÍ∞Ä ÏÑ†ÌÉùÌïú Ï†ïÎ†¨Ï°∞Í±¥
        sortOptions: [
            { text: "Í±∞Î¶¨ Ïàú", value: "distance" }, // ÏÑúÎ≤ÑÎ°ú ÎÑòÍ∏∏ Í∞í: distance
            { text: "Î≥ÑÏ†ê Ïàú", value: "rating" },    // ÏÑúÎ≤ÑÎ°ú ÎÑòÍ∏∏ Í∞í: rating
            { text: "Î¶¨Î∑∞ Ïàú", value: "review" }     // ÏÑúÎ≤ÑÎ°ú ÎÑòÍ∏∏ Í∞í: review
        ], // Ï†ïÎ†¨ ÏòµÏÖò
        selectedTag: "Ï†ÑÏ≤¥",
        latitude: '37.544444', // ÏÇ¨Ïö©Ïûê ÌòÑÏû¨ ÏúÑÎèÑ
        longitude: '127.063087', // ÏÇ¨Ïö©Ïûê ÌòÑÏû¨ Í≤ΩÎèÑ

        hospitalList:[], // Î≥ëÏõêÎ¶¨Ïä§Ìä∏
        keywordList:[], // ÌÇ§ÏõåÎìú Î¶¨Ïä§Ìä∏ (, Í∏∞Ï§ÄÏúºÎ°ú split)

        // ÏòàÏãúÎç∞Ïù¥ÌÑ∞
        // keywordList:['Ï†ÑÎ¨∏Ïùò','Ï£ºÏ∞®Ïû•','ÏòàÎ∞©Ï†ëÏ¢Ö'],
        // hospital:[{
        //     id:'1', // Î≥ëÏõê id
        //     standby: '5', // Ïã§ÏãúÍ∞Ñ ÎåÄÍ∏∞Ïù∏Ïõê
        //     distance: '252m', // ÎÇ¥ÏúÑÏπò ~ Î≥ëÏõê ÏßÅÏÑ†Í±∞Î¶¨
        //     name: 'ÏÑúÏ¥àÏïÑÏù¥ ÏÜåÏïÑÏ≤≠ÏÜåÎÖÑÍ≥ºÏùòÏõê', // Î≥ëÏõêÏù¥Î¶Ñ
        //     hospitalImageUrl :'https://todak-file.s3.ap-northeast-2.amazonaws.com/default-images/hospital-example-image.png',
        //     address: 'ÏÑúÏö∏ Í∞ïÎÇ®Íµ¨ ÏÇºÏÑ±Î°ú14 (Í∞úÌè¨ÏûêÏù¥ ÌîÑÎ†àÏßÄÎçòÏä§) ÏûêÏù¥Ïä§ÌÄòÏñ¥ ÏÉÅÍ∞Ä 216Ìò∏', // Î≥ëÏõêÏ£ºÏÜå
        //     dong: 'Î∞©Î∞∞Îèô', // Î≥ëÏõêÏ£ºÏÜå(Îèô)
        //     keywords: 'Ï†ÑÎ¨∏Ïùò, Ï£ºÏ∞®Ïû•, ÏòàÎ∞©Ï†ëÏ¢Ö', // Î≥ëÏõê keywords
        //     dayOfWeek: 'ÌôîÏöîÏùº', // ÏöîÏùº
        //     openTime: '08:30', // ÏòÅÏóÖÏãúÏûë ÏãúÍ∞Å
        //     closeTime: '19:00', // ÏòÅÏóÖÏ¢ÖÎ£å ÏãúÍ∞Å
        //     todaySchedule: 'ÌôîÏöîÏùº 08:30 ~ 19:00', // Ïò§Îäò ÏòÅÏóÖÏãúÍ∞Ñ(ÏµúÏ¢Ö)
        //     averageRating: '4.5', // Î≥ëÏõê ÌèâÍ∑†ÌèâÏ†ê
        //     reviewCount: '32' // Î≥ëÏõêÎ¶¨Î∑∞Í∞úÏàò
        // }]
      }
    },
    created() {

    },
    mounted(){
        this.loadHospitalList();
    },
    methods: {
        openAddressSearch() {
            new window.daum.Postcode({
                oncomplete: (data) => {
                    // bnameÏóêÏÑú Îèô Ïù¥Î¶ÑÏùÑ Ï∂îÏ∂úÌïòÏó¨ dongÏóê Ìï†Îãπ
                    this.dong = data.bname || "Ï£ºÏÜå ÏÑ†ÌÉù ÏïàÎê®";
                }
            }).open();
        },
        async loadHospitalList(){
            try {
                let params = {
                    dong: this.dong,
                    latitude: this.latitude,
                    longitude: this.longitude
            };
                const response = await axios.get(`${process.env.VUE_APP_API_BASE_URL}/reservation-service/hospital/list`,{ params }
            );
                this.hospitalList = response.data.result.map(hospital => {
            return {
                    ...hospital,
                    keywordList: hospital.keywords ? hospital.keywords.split(",") : []
                };
            });
            }catch(error){
                console.log(error);
            }
        },
        goToDetail(hospitalId) {
            // Î≥ëÏõê ÏÉÅÏÑ∏ ÌéòÏù¥ÏßÄÎ°ú Ïù¥Îèô
            this.$router.push({ path: `/all/hospital/detail/${hospitalId}` });
        }
    }
}
</script>

<style scoped>
.custom-card {
    border: 2px solid #DBDBDB; /* ÌÖåÎëêÎ¶¨ ÏÉâÏÉÅÎßå Î≥ÄÍ≤Ω */
    border-radius: 10px; /* Î™®ÏÑúÎ¶¨ Îë•Í∏ÄÍ∏∞ */
    background-color: white !important; /* Ïπ¥Îìú ÎÇ¥Î∂Ä Î∞∞Í≤ΩÏÉâ Í≥†Ï†ï */
    width: 1000px !important;
    margin: 0 auto;
  }
/* v-avatar border-radius */
.custom-avatar {
    border-radius: 10px; /* AvatarÏóê 10px Îë•Í∏ÄÍ∏∞ Ï†ÅÏö© */
    width: 100%;
    height: 100%;
    object-fit: cover;
  }
  
/* v-card-title Ìè∞Ìä∏ Ïä§ÌÉÄÏùº */
.custom-card-title {
    font-weight: bold; /* Í∏ÄÏî® ÍµµÍ≤å */
    font-size: 23px; /* ÏõêÌïòÎäî Ìè∞Ìä∏ ÌÅ¨Í∏∞ ÏÑ§Ï†ï */
}
.rating-text{
    font-weight: bold;
    color: #00499E
}
.distance-text{
    font-weight: bold;
    color: #0066FF;
    font-size: 17px;
}
</style>
