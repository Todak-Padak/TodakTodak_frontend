<template>
  <v-container class="custom1-container">
    <!-- Ï†ÑÏ≤¥ ÎåÄÏãúÎ≥¥Îìú ÏòÅÏñµ -->
    <div class="dashboard-cards">

      <!-- Ï±ÑÌåÖÎ¶¨Ïä§Ìä∏ ÏòÅÏó≠ -->
      <div class="cslist-box">
        <!-- Ï±ÑÌåÖ Î¶¨Ïä§Ìä∏ -->
        <v-container class="wisdom-outer-box">
          <!-- Ï±ÑÌåÖÎ∞© Î¶¨Ïä§Ìä∏ -->
          <v-row class="wisdom-chat-list">
              <!-- Ï±ÑÌåÖÎ∞©Ïù¥ ÏóÜÎäî Í≤ΩÏö∞ ÌëúÏãúÌï† Î©îÏãúÏßÄ -->
              <v-col cols="12" v-if="chatRoomList.length === 0">
                  <p class="text-subtitle-1 mt-5 center-text">ÏïÑÏßÅ Ï∞∏Ïó¨ Ï§ëÏù∏ Ï±ÑÌåÖÎ∞©Ïù¥ ÏóÜÏäµÎãàÎã§.</p>
              </v-col>
              
              <v-col cols="12" >
                <!-- Ï±ÑÌåÖÎ∞© Ïπ¥Îìú -->
                <v-card 
                class="wisdom-list-card mb-3" 
                :class="{ 'wisdom-selected-card': chatRoom.chatRoomId === selectedChatRoomId }" 
                variant="flat"
                v-for="chatRoom in chatRoomList" 
                :key="chatRoom.chatRoomId"
                @click="selectChatRoom(chatRoom.chatRoomId)"
                >
                  <v-row>
                    <v-col cols=2>
                      <!-- ÏÜ°Ïã†Ïûê ÌîÑÎ°úÌïÑ Ïù¥ÎØ∏ÏßÄ -->
                      <v-avatar size="40" class="wisdom-sender-avatar mx-3 my-3">
                          <v-img :src="chatRoom.senderProfileImgUrl ? chatRoom.senderProfileImgUrl : 'https://todak-file.s3.ap-northeast-2.amazonaws.com/default-images/default_user_image.png'"
                          alt="Profile Image" />
                      </v-avatar>
                    </v-col>
                    <v-col cols="10">
                        <v-row class="d-flex justify-space-between">
                          <!-- ÏÜ°Ïã†Ïûê Ïù¥Î¶Ñ -->
                          <v-card-title class="mt-3 ml-3" style="font-weight:bold; font-size:15px;">
                              <span>{{ chatRoom.senderName }}</span>
                          </v-card-title>
                          
                          <!-- Ï±ÑÌåÖ Î≥¥ÎÇ∏ ÏãúÍ∞Å -->
                          <v-card-title class="mt-2 mr-3">
                          <span style="font-size: 10px; color:#9A9A9A;">{{ formatDate(chatRoom.recentChatTime) }}</span>
                          </v-card-title>
                        </v-row>
                        <v-row>
                          <!-- ÎßàÏßÄÎßâ Ï±ÑÌåÖ Î©îÏãúÏßÄ -->
                          <v-card-subtitle class="ml-3 mt-n2" style="font-size:13px;">
                              {{ chatRoom.lastMessage }}
                          </v-card-subtitle>
                        </v-row>
                    </v-col>
                  </v-row>
                </v-card>
              </v-col>
          </v-row>
        </v-container>
        
        <!-- ÌéòÏù¥ÏßÄ ÎÑ§Ïù¥ÏÖò -->
      </div>

      <!-- Ï±ÑÌåÖÏ∞Ω ÏòÅÏó≠ -->
      <div class="cschat-box">
        <!-- Ï±ÑÌåÖÎ∞© -->
        <v-container  id="messageContainer" class="messageContainer">
          <div>
            <div v-if="!selectedChatRoomId">
              <!-- ÏÑ†ÌÉùÌïú Ï±ÑÌåÖÎ∞©Ïù¥ ÏóÜÏùÑ Í≤ΩÏö∞ -->
              <p class="text-subtitle-1 mt-5 center-text">Ï±ÑÌåÖÎ∞©ÏùÑ ÏÑ†ÌÉùÌï¥Ï£ºÏÑ∏Ïöî</p>
            </div>
            <div class="chat-box">
              <div 
                v-for="(message, index) in messages" 
                :key="index" 
                :class="['message', { 'my-message': message.senderName === currentUserName, 'other-message': message.senderName !== currentUserName }]"
              >
                <!-- Î©îÏãúÏßÄ ÏΩòÌÖêÏ∏†ÏôÄ ÏïÑÎ∞îÌÉÄ -->
                <div class="message-wrapper">
                  <!-- ÏïÑÎ∞îÌÉÄ -->
                  <v-avatar size="50" class="mx-2">
                    <v-img :src="message.senderProfileImgUrl ? message.senderProfileImgUrl : 'https://todak-file.s3.ap-northeast-2.amazonaws.com/default-images/default_user_image.png'"/>
                  </v-avatar>
    
                  <!-- Î©îÏãúÏßÄ ÏΩòÌÖêÏ∏† -->
                  <div class="message-content mx-2">
                    <!-- Î©îÏãúÏßÄ Î≥∏Î¨∏ -->
                      {{ message.contents }}
                  </div>
                </div>
                <!-- Î©îÏãúÏßÄ ÏïÑÎûòÏóê ÌëúÏãúÎê† createdAt -->
                <div class="message-time mx-3">
                  {{ formatDate(message.createdAt) }}
                </div>
              </div>
            </div>
          </div>
        </v-container>
        <!-- Ï±ÑÌåÖ Ï†ÑÏÜ°Ï∞Ω -->
        <div class="input-box">
          <input v-model="messageToSend" @keyup.enter="sendMessage" placeholder="Î©îÏãúÏßÄÎ•º ÏûÖÎ†•ÌïòÏÑ∏Ïöî..." />
          <button @click="sendMessage">
            <v-icon style="color:#9A9A9A">mdi-send</v-icon>
          </button>
        </div>
      </div>

      <!-- CS ÏòÅÏó≠ -->
      <div class="list-box">
        <!-- ÌöåÏõêÏ†ïÎ≥¥ ÏòÅÏó≠ -->
        <div v-if="memberInfo" class="user-info">
          <v-avatar size="60" class="wisdom-sender-avatar mx-3">
            <v-img :src="memberInfo.profileImgUrl ? memberInfo.profileImgUrl : 'https://todak-file.s3.ap-northeast-2.amazonaws.com/default-images/default_user_image.png'"
            />
          </v-avatar>
          <div style="display: inline-block;">
            <p class="user-name">{{ memberInfo.name }}</p>
            <p class="user-type">{{ memberInfo.role }}</p>
          </div>
        </div>

        <div class="consultation-form">
          <div class="header">
            <p>ÏÉÅÎã¥ÎÇ¥Ïö©</p>
            <div style="margin-top: -20px;">
              <!-- ÏÉÅÎã¥ÎÇ¥Ïö© ÏàòÏ†ïÎ≤ÑÌäº -->
              <button v-if="hasCsData" @click="isEditMode = true">‚úèÔ∏è</button>
              <!-- ÏÉÅÎã¥ÎÇ¥Ïö© ÏÇ≠Ï†úÎ≤ÑÌäº -->
              <button v-if="hasCsData">üóëÔ∏è</button>
            </div>
          </div>
          <!-- ÏÉÅÎã¥ÎÇ¥Ïö© ÏûÖÎ†• Ï∞Ω -->
          <textarea 
          v-model="csContents" 
          :readonly="!isEditMode"
          class="textarea"
          :class="{ 'readonly-textarea': !isEditMode }"
          ></textarea>
          <div class="footer">
            <div class="status-section">
              <p class="mt-3">Ï≤òÎ¶¨ÏÉÅÌÉú</p>
              <select v-model="csStatus" class="status-select" style="height: 35px;" :disabled="!isEditMode">
                <option v-for="item in statusItems" :key="item.key" :value="item.value">
                  {{ item.value }}
                </option>
              </select>              
            </div>
            <!-- CS Îç∞Ïù¥ÌÑ∞Í∞Ä ÏûàÍ≥† ÏàòÏ†ï Î™®ÎìúÏùº Îïå: "ÏàòÏ†ïÏôÑÎ£å" -->
            <button 
            v-if="hasCsData && isEditMode" 
            @click="updateConsultation" 
            class="save-btn"
            >
            ÏàòÏ†ïÏôÑÎ£å
            </button>

            <!-- CS Îç∞Ïù¥ÌÑ∞Í∞Ä ÏóÜÍ≥† ÏàòÏ†ï Î™®ÎìúÏùº Îïå: "Ï†ÄÏû•" -->
            <button 
            v-if="!hasCsData && isEditMode" 
            @click="saveConsultation" 
            class="save-btn"
            >
            Ï†ÄÏû•
            </button>

          </div>
        </div>
        <div class="cs-list">
          <AdminCsListForCsChat v-if="memberInfo" :member-id="memberInfo.memberId" ref="csChatList"/>
        </div>
      </div>
    </div>

    <!-- ÏÉÅÎã¥ÎÇ¥Ïö© Ï†ÄÏû•,ÏàòÏ†ï,ÏÇ≠Ï†ú ÏôÑÎ£åÌñàÎã§Îäî Î™®Îã¨ -->
    <v-dialog
    v-model="csPostModal"
    width="auto"
  >
    <v-card
      max-width="400"
      :prepend-avatar="cs"
      :text="csPostModalContents"
      :title="csPostModalTitle"
      style="border-radius: 10px;"
    >
      <template v-slot:actions>
        <v-btn
          class="ms-auto"
          text="ÌôïÏù∏"
          @click="csPostModal = false"
        ></v-btn>
      </template>
    </v-card>
  </v-dialog>
  </v-container>
  <MyPageSideBar />
</template>

<script>
import { Stomp } from "@stomp/stompjs";
import SockJS from "sockjs-client";
import MyPageSideBar from "@/components/sidebar/MyPageSideBar.vue";
import AdminCsListForCsChat from "./AdminCsListForCsChat.vue";
import axios from "axios";

export default {
  components: {
    MyPageSideBar,
    AdminCsListForCsChat,
  },
  data() {
    return {
      selectedChatRoomId: null, // ÏÑ†ÌÉùÎêú Ï±ÑÌåÖÎ∞© IDÎ•º Ï†ÄÏû•Ìï† Î≥ÄÏàò
      stompClient: null,
      currentUserName: null, // ÌòÑÏû¨ Ï†ëÏÜçÌïú user Ïù¥Î¶Ñ
      messageToSend: '', // Î≥¥ÎÇº Î©îÏãúÏßÄ
      messages: [], // ÏàòÏã†Îêú Î©îÏãúÏßÄ Ï†ÄÏû•
      chatRoomId: '',  // Ï±ÑÌåÖÎ∞© id
      memberEmail: '',
      chatRoomList: [],
      itemsPerPage: 10,
      csPage: 1,
      memberInfo: null, // Ï±ÑÌåÖ Í±¥ ÌöåÏõêÏ†ïÎ≥¥
      memberId: '', // Ï±ÑÌåÖ Í±¥ ÌöåÏõêid
      csContents: '', // ÏÉÅÎã¥ÎÇ¥Ïö©
      csStatus: '',
      statusItems: [
        { key: 'INPROCESS', value: 'Ï≤òÎ¶¨Ï§ë' },
        { key: 'COMPLETED', value: 'Ï≤òÎ¶¨ÏôÑÎ£å' }
      ],
      cs: 'https://todak-file.s3.ap-northeast-2.amazonaws.com/default-images/cs_center_image.png',
      csPostModal: false,
      csPostModalTitle : "",
      csPostModalContents: "",
      isEditMode: true, // Ìé∏Ïßë Î™®Îìú ÏÉÅÌÉú Ï∂îÍ∞Ä
      hasCsData: false, // Ìï¥Îãπ Ï±ÑÌåÖÎ∞©Ïóê Ï°¥Ïû¨ÌïòÎäî CS Îç∞Ïù¥ÌÑ∞Í∞Ä ÏûàÎäîÏßÄ
    };
  },
  created() {
    this.loadMemberChatList(); // Ï±ÑÌåÖ Î¶¨Ïä§Ìä∏ load
    this.currentUserName = localStorage.getItem('name');  // ÌòÑÏû¨ Ï†ëÏÜçÌïú user Ïù¥Î¶Ñ
  },
  onBeforeUnmount() {
      this.disconnect(); // Ïª¥Ìè¨ÎÑåÌä∏ Ïñ∏ÎßàÏö¥Ìä∏ Ïãú ÏõπÏÜåÏºì Ïó∞Í≤∞ Ï¢ÖÎ£å
  },
  updated() {
      this.scrollToBottom(); // Î©îÏãúÏßÄÍ∞Ä ÏóÖÎç∞Ïù¥Ìä∏Îê† Îïå Ïä§ÌÅ¨Î°§ ÌïòÎã®ÏúºÎ°ú Ïù¥Îèô
    },
  methods: {
    connect(id) {
      this.chatRoomId = id;
      const socket = new SockJS('http://localhost:8080/member-service/ws/chat');
      this.stompClient = Stomp.over(socket);

      // JWT ÌÜ†ÌÅ∞ÏùÑ localStorageÏóêÏÑú Í∞ÄÏ†∏ÏôÄ auth-tokenÏúºÎ°ú ÏÑ§Ï†ï
      const token = localStorage.getItem('token');
      this.stompClient.connect({
        'token': `Bearer ${token}`  // ÌÜ†ÌÅ∞ÏùÑ Ìó§ÎçîÎ°ú Ï†ÑÏÜ°
      }, frame => {
        console.log('Connected: ' + frame);

        this.stompClient.subscribe(`/sub/${id}`, message => {
          console.log("Íµ¨ÎèÖÏãúÏûë");
          const receivedMessage = JSON.parse(message.body);
          this.messages.push({
            senderId: receivedMessage.senderId,
            senderName: receivedMessage.senderName,
            contents: receivedMessage.contents,
            senderProfileImgUrl: receivedMessage.senderProfileImgUrl,
            createdAt: receivedMessage.createdAt
          });
          this.scrollToBottom(); // ÏÉàÎ°úÏö¥ Î©îÏãúÏßÄ ÏàòÏã† Ïãú Ïä§ÌÅ¨Î°§ ÌïòÎã®ÏúºÎ°ú Ïù¥Îèô
        });
      }, error => {
        console.error('Connection error:', error);
        setTimeout(() => {
          this.connect(); // Ïó∞Í≤∞ Ïã§Ìå® Ïãú Ïû¨ÏãúÎèÑ
        }, 5000);
      });
    },
    sendMessage() {
      if (this.messageToSend.trim() !== '') {
        if (this.stompClient && this.stompClient.connected) {
          const message = {
            chatRoomId: this.chatRoomId,
            contents: this.messageToSend,
            token: localStorage.getItem('token')             
          };

          this.stompClient.send(`/pub/${this.chatRoomId}`, {}, JSON.stringify(message));
          this.messageToSend = ''; // ÏûÖÎ†• ÌïÑÎìú Ï¥àÍ∏∞Ìôî
          this.scrollToBottom();

        } else {
          console.error('STOMP client is not connected.'); // Ïó∞Í≤∞ÎêòÏßÄ ÏïäÏïòÏùÑ ÎïåÏùò ÏóêÎü¨ Ï≤òÎ¶¨
          alert('Ï±ÑÌåÖ ÏÑúÎ≤ÑÏóê Ïó∞Í≤∞ÎêòÏßÄ ÏïäÏïòÏäµÎãàÎã§.'); // ÏÇ¨Ïö©ÏûêÏóêÍ≤å ÏïåÎ¶º
        }
      }
    },
    disconnect() {
      return new Promise((resolve, reject) => {  
          if (this.stompClient && this.stompClient.connected) {
              // Íµ¨ÎèÖ Ìï¥Ï†ú
              if (this.subscription) {
                  this.stompClient.unsubscribe(this.subscription);
              }
              try {
                  this.stompClient.disconnect(() => {
                      this.isConnected = false; // Ïó∞Í≤∞ ÏÉÅÌÉú ÏóÖÎç∞Ïù¥Ìä∏
                      resolve();
                  });
              } catch (error) {
                  reject(error);
              }
          } else {
              resolve(); // Ïù¥ÎØ∏ Ïó∞Í≤∞ÎêòÏßÄ ÏïäÏùÄ ÏÉÅÌÉúÏùº Í≤ΩÏö∞
          }
      });
    },
    async selectChatRoom(id) {
      this.selectedChatRoomId = id; // ÏÑ†ÌÉùÌïú Ï±ÑÌåÖÎ∞© id
      this.chatRoomId = id; // Ï±ÑÌåÖÎ∞© id
      this.loadCSbyChatRoomId(id); // Ï±ÑÌåÖÎ∞© idÎ°ú CS Ï°∞Ìöå
      this.scrollToBottom();
      try {
        this.messages = [];
        this.connect(id); // Ìï¥Îãπ Ï±ÑÌåÖÎ∞© idÎ°ú ÏõπÏÜåÏºì Ïó∞Í≤∞
        this.loadChatMessages(id); // Ìï¥Îãπ Ï±ÑÌåÖÎ∞© Î©îÏãúÏßÄÎ¶¨Ïä§Ìä∏ Ï°∞Ìöå
        const member = await axios.get(`${process.env.VUE_APP_API_BASE_URL}/member-service/chat/member/info/chatroom/${id}`); // Ï±ÑÌåÖ Í±∏ÏùÄ ÌöåÏõêÏ†ïÎ≥¥
        this.memberInfo = member.data.result;
      } catch (e) {
        console.error(e);
      }
    },
    // Ï±ÑÌåÖÎ∞© Î©îÏãúÏßÄ Î¶¨Ïä§Ìä∏ Ï°∞Ìöå
    async loadChatMessages(id){
      try{
        const response = await axios.get(`${process.env.VUE_APP_API_BASE_URL}/member-service/chat/chatroom/${id}/messages`);
        this.messages = response.data.result;
        console.log(response.data);
      }catch(error){
        console.log(error);
      }
    },
    // Ï±ÑÌåÖÎ∞© Î¶¨Ïä§Ìä∏ (adminÏûÖÏû• Ï±ÑÌåÖÎ∞© Î¶¨Ïä§Ìä∏)
    async loadMemberChatList(){
      try {
          const response = await axios.get(`${process.env.VUE_APP_API_BASE_URL}/member-service/chat/chatroom/list/admin`);
          this.chatRoomList = response.data.result.content;
      } catch (error) {
          console.log(error);
      }
    },
    // Ï±ÑÌåÖÎ∞© idÎ°ú CS Ï°∞Ìöå
    async loadCSbyChatRoomId(id){
      try{
        const response = await axios.get(`${process.env.VUE_APP_API_BASE_URL}/member-service/cs/detail/chatroom-id/${id}`);
        if (response.data.result && response.data.result.length > 0) {
          this.csContents = response.data.result[0].csContents;
          this.csStatus = response.data.result[0].csStatus;
          this.isEditMode = false; // CS Îç∞Ïù¥ÌÑ∞Í∞Ä ÏûàÏùÑ Í≤ΩÏö∞ ÏùΩÍ∏∞ Ï†ÑÏö© Î™®ÎìúÎ°ú ÏÑ§Ï†ï
          this.hasCsData = true; // Ìï¥Îãπ Ï±ÑÌåÖÎ∞©Ïóê CS Îç∞Ïù¥ÌÑ∞ ÏûàÏùå (ÏàòÏ†ï, ÏÇ≠Ï†úÎ≤ÑÌäº Î≥¥ÏûÑ)
        }else {
          this.csContents = ''; // Îç∞Ïù¥ÌÑ∞Í∞Ä ÏóÜÏùÑ Í≤ΩÏö∞ Ï¥àÍ∏∞Ìôî
          this.csStatus = '';
          this.isEditMode = true; // CS Îç∞Ïù¥ÌÑ∞Í∞Ä ÏóÜÏùÑ Í≤ΩÏö∞ Ìé∏Ïßë Î™®ÎìúÎ°ú ÏÑ§Ï†ï
          this.hasCsData = false;
        }
      }catch(error){
        console.log(error);
      }
    },
    // ÏÉÅÎã¥ÎÇ¥Ïö© Ï†ÄÏû•(create)
    async saveConsultation(){
      // selectedStatus Ï°∞Í±¥Ïóê ÎßûÎäî item Í∞ùÏ≤¥Í∞Ä ÏûàÎã§Î©¥ item.key Í∞íÏùÑ Í∞ñÍ≥†, ÏóÜÎã§Î©¥ undefined
      const selectedStatus = this.statusItems.find(item => item.value === this.csStatus)?.key;
      
      const body = {
        chatRoomId: this.chatRoomId, // Ï±ÑÌåÖÎ∞© Id
        csContents: this.csContents, // ÏÉÅÎã¥ÎÇ¥Ïö©
        csStatus: selectedStatus // Î≥ÄÌôòÎêú key Í∞í ÏÇ¨Ïö©
      };
      
      try{
        const response = await axios.post(`${process.env.VUE_APP_API_BASE_URL}/member-service/cs/create`, body);
        console.log(response.data);
        this.csPostModal = true;
        this.csPostModalTitle = 'CS ÏÉÅÎã¥ÎÇ¥Ïö© Ï†ÄÏû•ÏôÑÎ£å',
        this.csPostModalContents = 'CS ÏÉÅÎã¥ÎÇ¥Ïö©Ïù¥ ÏÑ±Í≥µÏ†ÅÏúºÎ°ú Ï†ÄÏû•ÎêòÏóàÏäµÎãàÎã§!'
        this.$refs.csChatList.fetchCsList(); // fetchCsList Ìò∏Ï∂ú
      }catch(error){
        console.log(error);
      }
    },
    // ÎÇ†Ïßú Ìè¨Îß∑ÌåÖ Ìï®Ïàò
    formatDate(date) {
      return new Date(date).toLocaleString();
    },
    scrollToBottom() {
      const chatBox = document.querySelector('.cschat-box');
      if (chatBox) {
        chatBox.scrollTop = chatBox.scrollHeight; // ÏµúÌïòÎã®ÏúºÎ°ú Ïä§ÌÅ¨Î°§
      }
    },
  },
  computed: {

  }
};
</script>

<style scoped>
* {
  user-select: none;
}

.custom1-container {
  /* */
  width: 100%;
  max-width: 1600px; 
  max-height: 600px;
  margin: 0 auto;
}

.dashboard-cards {
  /* */
  display: flex;
}

.list-box {
  /* */
  background-color: #F7F7F7;
  padding: 10px;
  margin: 10px 10px;
  min-height: 580px;
  width: 500px;
  border-radius: 10px;
  position: relative;
  padding-bottom: 90px;
}

.cslist-box {
  /* Ï±ÑÌåÖÎ∞© Î¶¨Ïä§Ìä∏ ÏòÅÏó≠ */
  background-color: #F7F7F7;
  margin: 10px 10px;
  min-height: 100%;
  border-radius: 10px;
  position: relative;
  padding-bottom: 90px;
  width: 450px;
}
.wisdom-outer-box {
  display: flex;
  justify-content: center;
  width: 100%;
  margin: 0px !important;
}
.wisdom-sender-avatar{
  object-fit: cover;
  width: 100%;
  height: 100%;
}
.wisdom-list-card{
  background-color:#ffffff;
  border-radius: 10px;
}
.wisdom-selected-card {
  background-color: #C2D7FF !important; /* ÏÑ†ÌÉùÎêú Ïπ¥ÎìúÏùò Î∞∞Í≤ΩÏÉâ */
}
.wisdom-chat-list {
  position: relative; /* Î∂ÄÎ™® ÏöîÏÜåÎ•º relativeÎ°ú ÏÑ§Ï†ï */
}

.cschat-box {
  /* Ï±ÑÌåÖÎ∞© ÏòÅÏó≠ */
  background-color: #F7F7F7;
  margin: 10px 10px;
  min-height: 580px;
  border-radius: 10px;
  position: relative;
  width: 600px;
  overflow-y: hidden; /* ÎÇ¥Î∂Ä ÏöîÏÜåÏùò Ïä§ÌÅ¨Î°§ÏùÑ ÏúÑÌï¥ overflow-yÎ•º hiddenÏúºÎ°ú ÏÑ§Ï†ï */
  display: flex;
  flex-direction: column;
}

.chat-box {
  flex: 1; /* ÎÇ®ÏùÄ Í≥µÍ∞ÑÏùÑ Ï∞®ÏßÄÌïòÍ≤å ÏÑ§Ï†ï */
  height: calc(580px - 35px) !important; /* .cschat-box ÎÜíÏù¥ÏóêÏÑú padding-bottomÏùÑ Î∫Ä Í∞íÏúºÎ°ú ÏÑ§Ï†ï */
  overflow-y: auto; /* Ïä§ÌÅ¨Î°§ Í∞ÄÎä•ÌïòÍ≤å ÏÑ§Ï†ï */
  width: 100%;
  margin: 0 auto !important;
}

.input-box {
  position: absolute;
  bottom: 0;
  left: 0;
  right: 0;
  display: flex;
  gap: 10px;
  padding: 10px;
  background-color: #ff9e9e;
  border-top: 1px solid #ddd;
}
.messageContainer{
  min-height: 580px;
  background-color: #ffffff;
}
/* ÏïÑÎ∞îÌÉÄÏôÄ Î©îÏãúÏßÄÎ•º Í∞êÏã∏Îäî ÎûòÌçº */
.message-wrapper {
  display: flex;
  align-items: center;
  margin-bottom: 10px;
}

.my-message .message-wrapper {
  flex-direction: row-reverse; /* ÎÇ¥Í∞Ä Î≥¥ÎÇ∏ Î©îÏãúÏßÄÏùº Îïå ÏΩòÌÖêÏ∏†ÏôÄ ÏïÑÎ∞îÌÉÄ ÏàúÏÑú Î≥ÄÍ≤Ω */
}

.message-content {
  max-width: 60%;
  padding: 10px;
  border-radius: 10px;
  background-color: #f1f1f1;
}

/* Î©îÏãúÏßÄ Î∞úÏã†Ïûê Ïù¥Î¶ÑÏùÄ ÎßêÌíçÏÑ† ÏúÑÏóê */
.message-sender {
  font-weight: bold;
  margin-bottom: 5px;
}

.my-message .message-sender {
  text-align: right;
}

.other-message .message-sender {
  text-align: left;
}

/* Î©îÏãúÏßÄ Î≥∏Î¨∏ÏùÄ Ï§ëÏïô */
.message-bodys {
  padding: 5px 0;
}

/* Î©îÏãúÏßÄ ÏãúÍ∞ÑÏùÄ ÎßêÌíçÏÑ† ÏïÑÎûòÏóê */
.my-message .message-time {
  font-size: 0.8em;
  color: #888;
  margin-top: 5px;
  text-align: right;
  margin-bottom: 5px;
}  

/* Î©îÏãúÏßÄ ÏãúÍ∞ÑÏùÄ ÎßêÌíçÏÑ† ÏïÑÎûòÏóê */
.other-message .message-time {
  font-size: 0.6em;
  color: #888888;
  margin-top: 5px;
  text-align: left;
  margin-bottom: 5px;
}  

.my-message .message-content {
  background-color: #007bff; /* ÎÇ¥Í∞Ä Î≥¥ÎÇ∏ Î©îÏãúÏßÄ ÏÉâÏÉÅ */
  color: #FFFFFF;
  text-align: left;
}

.other-message .message-content {
  background-color: #EFEFEF; /* ÏÉÅÎåÄÎ∞© Î©îÏãúÏßÄ ÏÉâÏÉÅ */
  text-align: left;
}

input {
  flex: 1;
  padding: 5px;
}

button {
  padding: 5px 10px;
}

.cs-user {
  /* */
  background-color: white;
  border-radius: 10px;
  padding: 10px;
  height: 270px;
}

.cs-list {
  /* */
  background-color: white;
  margin-top: 20px;
  border-radius: 10px;
  min-height: 330px;
}

.subtitle {
  /* */
  text-align: center;
  font-size: 20px;
  color: #0066FF;
  margin: 10px 0;
}

.cs {
  /* */
  background-color: white;
  height: 80px;
}

.pagination {
  /* */
  margin-top: 20px;
  display: flex;
  margin-right: 40px;
  position: absolute;
  bottom: 20px;
  left: 0;
  right: 0;
}

.user-info {
  /* */
  display: flex;
  align-items: center;
  /* Ïù¥ÎØ∏ÏßÄÏôÄ ÌÖçÏä§Ìä∏Î•º ÏàòÏßÅÏúºÎ°ú Ï§ëÏïôÏóê Ï†ïÎ†¨ */
  border-bottom: 1px solid #bfbfbf;
  padding-bottom: 10px;
}

.user-name {
  /* ÌöåÏõêÏ†ïÎ≥¥ - Ïù¥Î¶Ñ*/
  font-weight: bold;
  font-size: 17px;
  margin-top: 5px;
}

.user-type {
  /* */
  margin-top: -15px;
  margin-left: 3px;
  color: #606060;
  font-size: 15px;
}

.cs-message {
  /* */
  font-family: 'Inter';
}

.consultation-form {
  /* */
  margin-top: 20px;
  padding: 20px;
  background-color: #fff;
  border-radius: 10px;
}

.header {
  /* */
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-top: -10px;
}

.textarea {
  /* CSÏÉÅÎã¥ÎÇ¥Ïö© ÏûëÏÑ± ÌÖçÏä§Ìä∏ÌïÑÎìú */
  width: 100%;
  height: 100px;
  padding: 10px;
  border-radius: 5px;
  border: 1px solid #ccc;
}
.readonly-textarea {
  width: 100%;
  height: 80px;
  padding: 10px;
  background-color: #f5f5f5; /* Î∞ùÏùÄ ÌöåÏÉâ Î∞∞Í≤Ω */
  color: #000000; 
}

.footer {
  /* */
  display: flex;
  justify-content: space-between;
  align-items: center;
}

.status-section {
  /* */
  display: flex;
  align-items: center;
  height: 10px;
}

.status-section p {
  /* */
  margin-right: 10px;
}

.status-select {
  /* */
  padding: 5px;
  border-radius: 5px;
  border: 1px solid #ccc;
}

.save-btn {
  padding: 8px 16px;
  background-color: #0075FF;
  color: white;
  border: none;
  border-radius: 5px;
  cursor: pointer;
  height: 35px;
}


</style>
